```
Title: API Hashing with Local Process Injection
Description:
```

### Initial Observation
```c


```

### Custom Implementation of GetProcAddress()
```
Our new implementation GetFuncAddress() will get a HMODULE (handle to the dll that contains the API we are looking for) and a hash of the API we a looking for. The function 
the loop trough function in the EAT and for each api calculate the hash and compare it to
hash value passed as imput. Once the api found, GetFuncAddress() returns the address where
the api is located. 
```

##### 1-PE Headers parsing
```c
//p_DOS_HDR
PIMAGE_DOS_HEADER p_DOS_HDR  = (PIMAGE_DOS_HEADER) dll_handle;
//p_NT_HDR
PIMAGE_NT_HEADERS p_NT_HDR = (PIMAGE_NT_HEADERS) ((LPBYTE)dll_handle + p_DOS_HDR->e_lfanew); // NT HEADERS start at the raw offset defined in the e_lfanew header
//peat(EXPORT ADDRESS TABLE)
PIMAGE_EXPORT_DIRECTORY peat = (PIMAGE_EXPORT_DIRECTORY)((LPBYTE)dll_handle + p_NT_HDR->OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);
```

##### 2-EAT
```c
DWORD numberOfNames = peat->NumberOfNames;
DWORD* functions_names = (DWORD*)((LPBYTE)dll_handle + peat->AddressOfNames);
WORD*  functions_ordinal = (WORD*)((LPBYTE)dll_handle + peat->AddressOfNameOrdinals);
DWORD* functions_address = (DWORD*)((LPBYTE)dll_handle + peat->AddressOfFunctions);
```

##### 3-The Search Loop
```c
for (size_t i =0; i<numberOfName; i++){
    /*
    for each api in the eat compute the hash and compare it to the hash value passed
    as argument
    */
}
```